repos:
- repo: local
  hooks:
    - id: dbt-get-manifest
      name: dbt-get-manifest
      entry: automate/dbt/get_artifacts.sh
      language: script
      types: [python]
      pass_filenames: false
- repo: https://github.com/datacoves/pre-commit-dbt
  rev: a9f897359ae9b5dca62090b3fbf6cadef5f63143
  hooks:
  - id: dbt-run
    files: ^transform/models/
    args: ["--models", "state:modified+", "--cmd-flags", "++defer", "++project+dir", "transform", "++state", "logs", "--"]
  - id: dbt-docs-generate
    files: ^transform/models/
    args: ["--cmd-flags", "++project+dir", "transform", "++no+compile"] 
  - id: check-source-table-has-description  
    files: ^transform/models/  
  - id: check-script-semicolon
    files: ^transform/models/
  - id: check-script-has-no-table-name
    files: ^transform/models/
  - id: check-script-ref-and-source
    files: ^transform/models/
    args: ["--manifest", "transform/target/manifest.json"]
  - id: generate-model-properties-file
    args: ["--properties-file", "/models/{schema}/{name}.yml", "--manifest", "transform/target/manifest.json", "--catalog", "transform/target/catalog.json", "--"]

  - id: check-model-has-properties-file
    args: ["--manifest", "transform/target/manifest.json"]
    files: ^transform/models/
  - id: check-model-has-all-columns
    args: ["--manifest", "transform/logs/manifest.json", "--catalog", "transform/target/catalog.json"]
    files: ^transform/models/
    # files: ^transform/models/
  - id: check-model-has-description
    args: ["--manifest", "transform/target/manifest.json"]
    files: ^transform/models/
